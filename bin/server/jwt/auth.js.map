{"version":3,"sources":["../../../src/server/jwt/auth.js"],"names":["jwt","require","LocalStorage","localStorage","exports","validate","req","res","next","getItem","token","decoded","decode","process","env","JWT_TOKEN","_id","id","status","send","message"],"mappings":";;AAAA,MAAMA,GAAG,GAAGC,OAAO,CAAC,YAAD,CAAnB;;AAEA,MAAMC,YAAY,GAAGD,OAAO,CAAC,mBAAD,CAAP,CAA6BC,YAAlD;;AACA,MAAMC,YAAY,GAAG,IAAID,YAAJ,CAAiB,WAAjB,CAArB;;AAEAE,OAAO,CAACC,QAAR,GAAmB,UAASC,GAAT,EAAcC,GAAd,EAAmBC,IAAnB,EAAyB;AACxC,MAAIL,YAAY,CAACM,OAAb,CAAqB,OAArB,CAAJ,EAAmC;AAC/B,QAAIC,KAAK,GAAGP,YAAY,CAACM,OAAb,CAAqB,OAArB,CAAZ;;AAEA,QAAI;AACA,UAAIE,OAAO,GAAGX,GAAG,CAACY,MAAJ,CAAWF,KAAX,EAAkBG,OAAO,CAACC,GAAR,CAAYC,SAA9B,CAAd;AAEAT,MAAAA,GAAG,CAACU,GAAJ,GAAUL,OAAO,CAACM,EAAlB;AACAT,MAAAA,IAAI;AACP,KALD,CAKE,MAAM;AACJ,aAAOD,GAAG,CAACW,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAACC,QAAAA,OAAO,EAAE;AAAV,OAArB,CAAP;AACH;AACJ,GAXD,MAWO;AACH,WAAOb,GAAG,CAACW,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAACC,MAAAA,OAAO,EAAE;AAAV,KAArB,CAAP;AACH;AACJ,CAfD","sourcesContent":["const jwt = require(\"jwt-simple\");\n\nconst LocalStorage = require(\"node-localstorage\").LocalStorage;\nconst localStorage = new LocalStorage(\"./scratch\");\n\nexports.validate = function(req, res, next) {\n    if (localStorage.getItem(\"token\")) {\n        let token = localStorage.getItem(\"token\");\n\n        try {\n            let decoded = jwt.decode(token, process.env.JWT_TOKEN);\n\n            req._id = decoded.id;\n            next();\n        } catch {\n            return res.status(401).send({message: \"Invalid token.\"});\n        }\n    } else {\n        return res.status(401).send({message: \"Token must be provided.\"});\n    }\n};\n"],"file":"auth.js"}